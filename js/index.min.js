!function e(t,n,i){function a(s,c){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!c&&u)return u(s,!0);if(r)return r(s,!0);var o=new Error("Cannot find module '"+s+"'");throw o.code="MODULE_NOT_FOUND",o}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return a(n||e)},l,l.exports,e,t,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)a(i[s]);return a}({1:[function(e,t,n){"use strict";!function(){var e={init:function(){var e=this;this.dataPromises=[];return["Sheet1"].forEach(function(t){var n=new Promise(function(n,i){d3.json("https://sheets.googleapis.com/v4/spreadsheets/1t9kREavKorCycwgxrOIdS-Zk0OJWTB3BDW6v7xu5zo4/values/"+t+"?key=AIzaSyDD3W5wJeJF2esffZMQxNtEl9tt-OfgSq4",function(t,a){if(t)throw i(t),t;var r=a.values;n(e.returnKeyValues(r,"category"))})});e.dataPromises.push(n)}),Promise.all(this.dataPromises)},returnKeyValues:function(t,n){var i=t.slice(1).map(function(e){return e.reduce(function(e,n,i){return e[t[0][i]]=isNaN(+n)?n:+n,e},{})});return n?(e.unrolled=i,function(e){return d3.nest().key(function(e){return e[n]}).entries(e)}(i)):i}},t={init:function(){e.init().then(function(t){e.data=t[0],e.selectedTax=d3.select("#price-selector").node().value,d3.select("#price-selector").on("change",function(){e.selectedTax=d3.event.target.value,n.updateTaxPerUnit(),n.updateBarCharts(),n.updatePriceDivs()}),n.init()})}},n={fadeInHTML:function(e){this.each(function(e,t,n){}),this.transition().duration(n.duration/2).ease(d3.easeCubicOut).style("opacity",0).on("end",function(t){var i=d3.select(this);i.html(function(){return e(t)}),i.transition().duration(n.duration/2).ease(d3.easeCubicOut).style("opacity",1)})},init:function(){this.duration=750,this.transition=function(){d3.transition().duration(n.duration).ease(d3.easeCubicOut)};var t=d3.select("#d3-content").selectAll("categories").data(e.data).enter().append("div").classed("category",!0).classed("no-prices",function(e){return!("For homes and businesses"===e.key||"Coals by type"===e.key||"Other transportation fuels"===e.key)});t.append("div").classed("category-heading margins flex-container flex-start",!0).append("h3").classed("no-margin",!0).text(function(e){return e.key});var i=t.append("div").classed("fuel column-labels flex-container margins flex-start",!0);i.append("p").classed("column-label label-fuel no-margin",!0).text("");var a=i.append("div").classed("data-headings flex-container flex-start",!0);a.append("p").classed("column-label label-co2-emissions no-margin",!0).html("kg of CO&#8322;"),a.append("p").classed("column-label label-tax no-margin",!0).text("carbon tax"),a.append("p").classed("column-label label-price no-margin",!0).text("price change per unit");var r=t.selectAll("fuels").data(function(e){return e.values}).enter().append("div").classed("fuel flex-container margins flex-start",!0);r.append("p").classed("fuel-name no-margin",!0).text(function(e){return e.fuel});var s=r.append("div").classed("fuel-data flex-container grow",!0);this.co2Emissions=s.append("p").classed("no-margin co2-emissions",!0),this.updateEmissions(),this.taxPerUnit=s.append("p").classed("no-margin tax-per-unit",!0),this.updateTaxPerUnit(),this.chartWrappers=s.append("div").classed("chart-wrapper grow",!0),this.chartDivs=this.chartWrappers.append("div").classed("chart-container flex-container",!0),this.createBarCharts()},updateEmissions:function(){n.fadeInHTML.call(n.co2Emissions,function(e){return isNaN(e.kg_unit)?"n.a. <br />("+e.kg_btu+" / BTU )":e.kg_unit<1e3?d3.format(",")(e.kg_unit)+" / "+e.unit+"<br />("+e.kg_btu+" / BTU )":d3.format(",.0f")(e.kg_unit)+" / "+e.unit+"<br />("+e.kg_btu+" / BTU )"})},updateTaxPerUnit:function(){n.fadeInHTML.call(n.taxPerUnit,function(t){return isNaN(t.kg_unit)?"n.a.":"$"+d3.format(",.2f")(t.kg_unit/1e3*e.selectedTax)+" / "+t.unit})},updatePriceDivs:function(){n.fadeInHTML.call(n.priceDivs,function(t){return"null"!==t.price_unit?"($"+d3.format(",.2f")(t.price_unit)+" &rarr; $"+d3.format(",.2f")(t.price_unit+t.kg_unit/1e3*e.selectedTax)+")":"not provided"})},createBarCharts:function(){var t=d3.extent(d3.select("#price-selector").node().options,function(e){return+e.value}),n=[d3.min(e.unrolled,function(e){return e.kg_unit/1e3*t[0]/e.price_unit*100}),d3.max(e.unrolled,function(e){return e.kg_unit/1e3*t[1]/e.price_unit*100})];this.scale=d3.scaleLinear().domain([0,n[1]]).range([0,1]),window.scale=this.scale,this.barCharts=this.chartDivs.append("div").classed("bar",!0).classed("bar-null",function(e){return"null"===e.price_unit}),this.percentDivs=this.chartDivs.append("div").classed("percent-div",!0),this.priceDivs=this.chartDivs.append("div").classed("price-div",!0),this.updateBarCharts()},updateBarCharts:function(){var t=this;this.barCharts.transition(n.transition).style("transform",function(n){if("null"!==n.price_unit)return"scale("+t.scale(n.kg_unit/1e3*e.selectedTax/n.price_unit*100)+", 1)"}),n.fadeInHTML.call(n.percentDivs,function(t){if("null"!==t.price_unit)return d3.format(",.0f")(t.kg_unit/1e3*e.selectedTax/t.price_unit*100)+"%"}),n.percentDivs.transition(n.transition).style("left",function(n){return"calc("+100*t.scale(n.kg_unit/1e3*e.selectedTax/n.price_unit*100)+"% + 5px)"}),n.updatePriceDivs()}};t.init()}()},{}]},{},[1]);